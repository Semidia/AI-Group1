# 🛠️ 主持人操作手册

作为主持人（Host），你是游戏规则的制定者和推进者。本手册将指导你如何配置房间、接入 AI 并掌控游戏节奏。

## 1. 房间创建

1.  登录后在游戏大厅点击 **"创建房间"**。
2.  填写基本信息：
    -   **房间名称**：清晰易懂的标题。
    -   **最大人数**：限制可加入的真实玩家数量。
    -   **密码**（可选）：私密游戏建议设置。
3.  创建后你将自动成为 **房主（Host）** 并进入房间。

---

## 2. 核心配置 (Host Setup)

在所有玩家准备好之前，你需要点击 **"主持人设定"** 完成初始化。这是一个向导式的流程：

### 第一步：API 配置
这是游戏的大脑。
-   **API Provider**：选择 `openai` 或 `custom`。
-   **Endpoint**：LLM 服务的接口地址。
-   **Headers**：填入你的 API Key（例如 `{"Authorization":"Bearer sk-..."}`）。
-   **Body 模板**：配置请求结构，系统会用 `{{prompt}}` 自动替换每轮的上下文。

### 第二步：规则与玩家
-   **游戏规则**：在文本框中输入游戏的背景设定和胜负规则。这会直接作为 System Prompt 的一部分发送给 AI。
-   **总决策主体数**：**重要！** 等于 `人类玩家数 + AI 玩家数`。
    -   例如有 3 个真人，你想加 2 个 AI 对手，此处填 5。
-   **决策时限**：设置每回合玩家思考的时间（分钟）。

### 第三步：验证与完成
-   点击 **"标记验证通过"** 确认配置无误。
-   最后点击 **"完成配置"**。此时房间状态变为 `waiting`，等待玩家准备。

---

## 3. 游戏控制

当所有玩家加入并准备就绪后，你可以点击 **“开始游戏”**。

### 循环流程
1.  **决策阶段**：
    -   等待玩家提交行动。你可以看到所有人的提交状态。
    -   倒计时结束或全员提交后，游戏进入下一阶段。
2.  **评审阶段 (Review)**：
    -   **关键权力**：在这个阶段，你可以查看每个人提交的文本。
    -   **干预**：如果玩家输入了违规内容或不合理的指令，你可以进行 **修改**。
    -   确认无误后，点击 **"提交给 AI 推演"**。
3.  **推演阶段**：
    -   系统调用配置好的 LLM API。
    -   等待后端返回生成的剧情和数值变化。
4.  **结果阶段**：
    -   全员展示本轮结果。
    -   你可以在此阶段发表评论或通过 WebSocket 广播系统消息。
    -   点击 **"进入下一回合"** 继续游戏。

---

## 4. 故障处理

-   **玩家掉线**：系统支持重连。让玩家刷新页面重新进入房间即可。
-   **AI 报错**：
    -   检查后端控制台日志。
    -   通常是 API Key 过期或网络超时。你可以在游戏中途重新进入“主持人设定”更新 API 配置。
-   **游戏卡死**：作为最后的手段，可以使用后台管理权限重置房间状态（需联系超级管理员）。

---

*掌控全场，享受博弈！*
