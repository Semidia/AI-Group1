# 🤝 AI-Group1 小组协作与同步指南

本文档旨在指导小组成员如何从 GitHub 拉取项目并进行一键配置，确保每个人都能在几分钟内拥有一致的运行环境。

## 📥 环境拉取与系统启动

### 1. 核心启动方式 (五秒启动)
当你从 GitHub 拉取最新代码后，**唯一需要做的事情**就是：
- 在项目根目录，双击运行 **`run-dev.bat`**。

### 2. 这个脚本在背后做了什么？
为了实现“直接可玩”，由于 `node_modules` 和 `.env` 不会被同步到 GitHub，脚本会自动执行以下流程：
1. **依赖补全**：自动执行 `npm install`。
2. **环境注入**：检测并自动生成本地 `.env` 文件。
3. **基础设施**：自动调用 Docker 启动 PostgreSQL 和 Redis。
4. **数据库重塑**：即使数据库一开始是空的，脚本会自动执行 `Prisma Migrate` 和 `Prisma Seed`（种子填充）。

---

## 💾 数据管理与同步规范

由于数据库的二进制文件（`data/` 目录）不通过 Git 同步，我们采用以下策略保持数据一致：

### 1. 静态数据 (种子同步)
- **规则**：所有必须存在的初始数据（如房间规则、默认 AI 配置、任务模板）请写在 `rebuild/production/backend/scripts/seed.ts` 中。
- **操作**：当你修改了 `seed.ts` 并提交后，队友只需再次运行 `npm run seed` 即可同步这些关键数据。

### 2. 动态数据 (保存与导出)
- **规则**：游戏过程中的存档数据保存在本地数据库中。
- **导出**：如果需要分享特定的游戏存档，请使用前端的“存档管理”导出功能（或通过 `tools/` 中的数据库备份脚本）。

---

## ⚠️ 注意事项与排错

### 1. 关于 .env 文件
- **不要提交 `.env` 到 GitHub**。每个人本地的密钥和路径可能略有不同。
- 如果你新增了环境变量（如 API Key），请务必更新 **`.env.example`**。

### 2. 关于 Docker
- 确保你的电脑上已经安装并启动了 **Docker Desktop**。
- 如果 `run-dev.bat` 报错找不到数据库，请手动在终端运行：
  ```powershell
  docker-compose up -d postgres redis
  ```

### 3. 数据重置
- 如果你想彻底清理本地测试数据并重回“出厂设置”，可以运行：
  ```powershell
  cd rebuild/production/backend
  npm run prisma:migrate:reset
  ```
  *(注：该命令会清空所有数据并重新运行 seed。)*

---

祝大家开发愉快！
© 2024 AI-Group1 开发团队
