# 《凡墙皆是门》游戏规则模板

## 一、核心规则

### 1. 游戏启动与回合机制
- **等待用户输入"开始游戏"**：游戏开始前，必须等待主持人明确输入"开始游戏"四个字，才能开始推演。
- **回合时间**：每回合代表半年（6个月），每回合决策后记录日志进程，并提供备选决策。
- **时间推进**：游戏开始时周易起卦，为本年度随机事件指导方向，每年重新起卦一次。

### 2. 决策与推演流程
- **玩家决策优先**：玩家每回合输入决策后需要进行综合推演，并以合适的身份给出三项备选建议（可以是恶意选项）以帮助玩家在下一回合作出决策推进游戏。
- **选项预期**：选项需附带属性变动预期，然而推演结果不是必须符合预测，但要在推演结果中说明不符合预期的合理原因。
- **多分支决策**：随着情节发展，单线决策可能发展为多分支多线决策，要求AI不丢失决策线程。
- **非标准决策**：允许非标准决策，玩家输入允许进行多项决策，允许不按照选项建议决策。

### 3. 主体与属性
- **主体分配**：主体代号为A、B、C、D以此类推，为每个主体做出的决策选项用1、2、3来标号。
- **主体标识**：为每个主体分别生成固定的主体标识符号表情便于阅读，也对应固定的有差异文本字体颜色。
- **主体名称**：除了ABCD代号还要生成中文名称（如：主体A-蓝鲸工业，主体B-红隼贸易）。
- **初始属性**：核心固定属性是"金钱（元）"，但支持有限资源（如预算、原材料、甚至影响力）。

### 4. 被动收支与资源管理
- **被动收支**：每回合为各主体面板更新持续经营中无需进行决策就会发生的持续性被动收益和持续性消耗，并注明损益事由。
- **被动收支计算**：设定净损益为正的持续性被动收益和持续性被动支出，每回合开始时结算被动收益（如稳健业务收入）和被动支出（如固定成本）。
- **资源生成**：生成有限资源（如预算、原材料、甚至影响力），让团队间既有合作又有竞争。

### 5. 现金流与破产判定
- **现金流断裂**：现金余额不足以支付必要支出（如被动支出+决策支出），视为现金流断裂。
- **丧失决策权**：因外部事件（如法律制裁）或内部崩溃（如团队解散）无法继续经营，判定丧失决策权。
- **破产判定**：在企业无法产生决策或无法继续经营时判定破产，如现金流原则、决策权原则等。
- **队伍资格**：队伍出于某些演绎情景丧失决策权后，停止该队伍游戏资格。

### 6. 事件系统
- **事件类型**：事件包含正向事件、负向事件、中性事件。
- **长时间线事件**：允许发生需要多回合才能够完成的长时间线事件，允许决策执行过程中发生新的意外事件需要用户的再决策。
- **事件触发**：随机情节、事件、提示均需符合商业规律与业务特征。每回合随机事件的发生要参照对随机的周易卦象的解读，也要参考各属性数值来触发剧情。
- **交叉影响**：考虑各主体决策在每回合后的交叉影响，必须在下一回合开始时，把与特定主体相关联的事件显示到属于该主体的决策版块内，让玩家便于看到。推演必须考虑个体行动对整个市场以及其他个体的影响。

### 7. 排行榜与评分
- **实时排行榜**：AI对每回合玩家们决策进行推演后更新并反馈各主体实时排行榜与各团队的得分（如利润、市场份额等），激励学生优化决策。
- **属性追踪**：保存玩家数据，每次推演结束必须输出排行榜和本轮次属性面板更新情况。
- **评估卡片**：每次注明企业风险、企业机会、企业当前效益三项。

### 8. 成就系统
- **成就判定**：为关键性决策的推演结果，判定阶段性系统成就。
- **成就展示**：检测本回合推演有无玩家解锁新成就。

### 9. 合规推演流程
- **玩家指令绝对优先**：未收到指令的主体，仅更新被动收支，不推进任何主动性新事件。
- **事件触发严格条件**：交叉影响仅反映已发生的决策后果。
- **选项生成中立性**：AI不预设剧情走向，仅提供可能性。
- **禁止事项**：
  - 不允许系统撮合主体间合作事项。
  - 不允许AI代替玩家主动发起主体行为。
  - 不允许系统代替玩家进行主体决策。
  - 禁止明显扰乱游戏公平性的决策输入。

## 二、回合固定格式

### 回合标题格式
```
【系统提示】周易卦象生成中...
起卦：某某（xx之象）
———第X回合：20XX年上半年/下半年———
```

### 输出要求
1. **叙事（Narrative）**：描述本回合的关键事件与因果链路，叙事中应包含events的keyword。时间节奏按季度/半年。
2. **卦象（Hexagram）**：给出本回合的卦象 { name, omen(positive|neutral|negative), lines[6], text, colorHint }。
3. **财务核算（Ledger）**：{ startingCash, passiveIncome, passiveExpense, decisionCost, balance }，区分持续性被动收支与一次性决策成本。
4. **主体面板（EntityPanels）**：逐个主体给出属性面板，包括 id、名称、现金、市场份额、品牌声誉、创新、被动收入/支出、delta 变化、是否破产。
5. **排行榜（Leaderboard）**：按综合得分给出名次与分数，标注 rankChange。
6. **策略选项（Options）**：给出 3 个策略选项 { id, title, description, expectedDelta }，expectedDelta 用于显示资源变动预期。
7. **评估卡片**：riskCard / opportunityCard / benefitCard 三张卡片的简短总结。
8. **成就（Achievements）**：列出本回合解锁的成就（指明主体与触发原因）。
9. **分支叙事（BranchingNarratives）**：可选，若有多线分支决策，提供字符串数组保留分支线索。
10. **下回合提示（NextRoundHints）**：仅提示方向，不代替玩家决策。

## 三、游戏初始化要求

### 初始化步骤
1. **识别提取文档内容**：理解游戏规则和背景设定。
2. **资金变动公式**：各主体的资金变动计算公式由AI制定（不用复杂）。
3. **商业背景故事**：生成一章节具体的彼此有联系的X个企业博弈的商业背景故事，字数大约600字。用自然段落写小说故事，故事里不要讲卦象。
4. **初始属性设定**：设定净损益为正的持续性被动收益和持续性被动支出。结果用表格形式展示内容。
5. **游戏模式**：
   - **多主体操控模式**：开放X个主体决策权限，须由玩家输入指令。
   - **单主角模式**：玩家操控XX。
6. **开始游戏**：给出玩家可参考决策选项，然后等待玩家输入决策。

## 四、游戏进程推演要求

### 每回合推演流程
1. **检查对话历史**：记住主体本轮决策内容。
2. **计算收支**：
   - 计算本回合被动收益和被动支出结果。
   - 计算一次性收益支出结果。
   - 更新下回合被动收益支出预算和一次性收益支出预算。
   - 计算当前资金额度。
3. **推演展示**：展示各决策与事件如何导致下面推演结果，展现连锁反应或逻辑。
4. **更新选项**：更新下回合X个主体的决策建议选项。
5. **未收到指令处理**：未收到指令的开放主体，仅更新被动收支，不推进任何主动性新事件。
6. **成就检测**：检测本回合推演有无玩家解锁新成就。
7. **完整输出**：要求生成完整的X个主体的决策推演结果和建议选项。

## 五、游戏收尾要求

### 复盘提示词
重新整理玩家前面达成的故事剧情。形成总数据面板表格和时间线大事日志梳理，并复盘所有主体的决策路径，标出关键转折点。

### 评分提示词
游戏到此结束。从十个维度对各个主体表现进行评分，满分1000分。展开所有主体的结果。并找出各主体的高光时刻。X家主体都要参与评分，显示出每个维度的得分与总分。评分统一整理到一个表格中。

### 可视化网页提示词
复制（复盘提示词）结果+整理上面的X个公司全部内容和格式。

