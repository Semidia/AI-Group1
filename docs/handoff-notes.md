# 项目交接嘱咐：邮箱模块移除与系统现状

你好！我是 Antigravity。在本次任务中，我已经完成了从本项目中 **全面移除邮箱模块** 的工作，并确保了系统的平稳运行。以下是关键信息和需要注意的事项。

## 1. 核心变更概览

- **身份验证模型**：系统现已转为 **纯用户名/密码** 认证模式。注册流程不再需要邮箱，找回密码功能已暂时关闭。
- **数据库架构**：`User` 模型中的 `email` 字段已被彻底物理删除（已应用 Prisma 迁移）。
- **后端同步**：所有路由（Auth, Admin, User, Trade, Rooms, Tasks, Strategies）均已同步，移除了对 `email` 的依赖，并解决了所有由于该变更引起的 TypeScript 编译错误。
- **前端适配**：登录和注册页面已简化，不再显示邮箱输入框。

## 2. 系统访问与权限

### 管理员默认凭据
系统初始化时会自动创建一个管理员账号（如果不存在）：
- **用户名**：`developer`
- **密码**：`000000`
- **权限**：具备完整后台管理权限，包括用户冻结、删除以及全局房间监控。

### 角色管理
- 用户的管理员身份目前通过 `username` 匹配（环境变量 `ADMIN_USERNAME`）或数据库中的权限字段进行判断。

## 3. 开发环境关键配置

### 数据库执行
运行以下命令确保数据库结构是最新的：
```bash
cd rebuild/production/backend
npx prisma generate
npx prisma migrate deploy
```

### 依赖版本重要提醒
为了解决之前遇到的类型推断问题，后端依赖已锁定在特定版本：
- `prisma`: `5.22.0`
- `@prisma/client`: `5.22.0`
**请不要随意降级这些包**，否则会导致 `UserCreateInput` 等类型报出“缺少 email”的虚假错误。

## 4. IDE 报错清理
我已经针对 IDE 报出的以下问题进行了修复：
1. **`ensureRoomHost` 相关问题**：已从 `trade.ts` 中移除未使用导入，并确认路由逻辑不再依赖它。
2. **返回值路径警告 (`rooms.ts`)**：已在相关路由中添加了显式的 `return;` 语句。
*如果你的 IDE 仍有红色波浪线，建议重启 TS Server。*

## 5. 后续建议
- **密码找回**：如果未来需要恢复密码找回，建议采用基于辅助问题的安全验证，而非邮箱。
- **多账户防止**：目前没有强制实名，一个用户可以随意注册多个账号。

---
*祝你的后续开发顺利！*
